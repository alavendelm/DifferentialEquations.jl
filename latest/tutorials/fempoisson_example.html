<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Poisson Equation Finite Element Method Example · DifferentialEquations.jl documentation</title><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script></head><body><nav class="toc"><h1>DifferentialEquations.jl</h1><form class="search" action="../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><span class="toctext">Tutorials</span><ul><li><a class="toctext" href="ode_example.html">Ordinary Differential Equation (ODE) Example</a></li><li><a class="toctext" href="sde_example.html">Stochastic Differential Equation (SDE) Example</a></li><li class="current"><a class="toctext" href="fempoisson_example.html">Poisson Equation Finite Element Method Example</a><ul class="internal"></ul></li><li><a class="toctext" href="femheat_example.html">Heat Equation Finite Element Method Example</a></li><li><a class="toctext" href="femstochastic_example.html">Stochastic Finite Element Examples</a></li></ul></li><li><span class="toctext">Solver Options</span><ul><li><a class="toctext" href="../solvers/ode_solve.html">Ordinary Differential Equation Solvers</a></li><li><a class="toctext" href="../solvers/sde_solve.html">Stochastic Differential Equation Solvers</a></li><li><a class="toctext" href="../solvers/fempoisson_solve.html">Finite Element Method Poisson Equation Solvers</a></li><li><a class="toctext" href="../solvers/femheat_solve.html">Finite Element Method Heat Equation Solvers</a></li><li><a class="toctext" href="../solvers/fdmstokes_solve.html">Finite Difference Method Stokes Equation Solvers</a></li></ul></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../man/overview.html">Overview of DifferentialEquations.jl Usage</a></li><li><a class="toctext" href="../man/ODEProblem.html">Defining an ODE Problem</a></li><li><a class="toctext" href="../man/SDEProblem.html">Defining a SDE Problem</a></li><li><a class="toctext" href="../man/FEMProblem.html">Defining a FEM Problem</a></li><li><a class="toctext" href="../man/StokesProblem.html">Defining a Stokes Problem</a></li><li><a class="toctext" href="../man/mesh.html">Meshes</a></li><li><a class="toctext" href="../man/solution.html">The Solution Type</a></li><li><a class="toctext" href="../man/output_specification.html">Output Specification</a></li><li><a class="toctext" href="../man/plot.html">Plot Functions</a></li><li><a class="toctext" href="../man/function_definition_macros.html">Function Definition Macros</a></li><li><a class="toctext" href="../man/benchmarks.html">Benchmark Suite</a></li><li><a class="toctext" href="../man/convergence.html">Convergence Simulations</a></li><li><a class="toctext" href="../man/conditional_dependencies.html">Conditional Dependencies</a></li><li><a class="toctext" href="../man/progress_bar.html">Juno Progress Bar Integration</a></li></ul></li><li><span class="toctext">Internal Documentation</span><ul><li><a class="toctext" href="../internals/contributors_guide.html">Contributor&#39;s Guide</a></li><li><a class="toctext" href="../internals/fem_tools.html">Internal Finite Element Tools</a></li><li><a class="toctext" href="../internals/extras.html">Extra Functions</a></li><li><a class="toctext" href="../internals/solver_helpers.html">Solver Helpers</a></li><li><a class="toctext" href="../internals/notes_on_algorithms.html">Notes on Algorithms</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Tutorials</li><li><a href="fempoisson_example.html">Poisson Equation Finite Element Method Example</a></li></ul><a class="edit-page" href="https://github.com/JuliaDiffEq/DifferentialEquations.jl/tree/c2bdaccda5210a9344aa45bc7e87efd657a73d9e/docs/src/tutorials/fempoisson_example.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/></header><h1><a class="nav-anchor" id="Poisson-Equation-Finite-Element-Method-Example-1" href="#Poisson-Equation-Finite-Element-Method-Example-1">Poisson Equation Finite Element Method Example</a></h1><p>This tutorial will introduce you to the functionality for solving a PDE. Other introductions can be found by <a href="https://github.com/JuliaDiffEq/DifferentialEquations.jl/tree/master/examples">checking out the IJulia notebooks in the examples folder</a>.</p><p>In this example we will solve the Poisson Equation <span>$Δu=f$</span>. For our example, we will take the linear equation where <span>$f(x,y) = \sin(2πx)\cos(2πy)$</span>. For this equation we know that solution is <span>$u(x,y,t)= \sin(2πx)\cos(2πy)/(8π^2)$</span> with gradient <span>$Du(x,y) = [\cos(2πx)\cos(2πy)/(4π) -\sin(2πx)\sin(2πy)/(4π)]$</span>. Thus, we define a PoissonProblem as follows:</p><pre><code class="language-julia">f(x) = sin(2π.*x[:,1]).*cos(2π.*x[:,2])
gD(x) = sin(2π.*x[:,1]).*cos(2π.*x[:,2])/(8π*π)
prob = PoissonProblem(f,gD)</code></pre><p>Or we can use the <code>@fem_define</code> macro to beautify our code. The first argument is the function signature, which here is <code>(x)</code>. Second it&#39;s a list of variables to convert. This makes more sense in the Heat Equation examples, so we put in the blank expresion <code>()</code> for now. Then we put in our expression, and lastly we define the parameter values. <code>@fem_define</code> will automatically replace <code>x</code> by <code>x[:,1]</code> and <code>y</code> by <code>x[:,2]</code>, and will also subtitute in the defined parameters. The previous definition using <code>@fem_define</code> is as follows:</p><pre><code class="language-julia">f  = @fem_define((x),(),begin
  sin(α.*x).*cos(α.*y)
end,α=&gt;2π)
gD = @fem_define((x),(),begin
  sin(α.*x).*cos(α.*y)/β
end,α=&gt;2π,β=&gt;8π*π)</code></pre><p>The linebreaks are not required but I think it makes it more legible!</p><p>Here we chose the dirichlet boundary condition <code>gD</code> to give the theoretical solution.  Other example problems can be found in <a href="https://github.com/JuliaDiffEq/DifferentialEquations.jl/tree/master/src/premades/premade_problems.jl">src/examples/exampleProblems.jl</a>. To solve this problem, we first have to generate a mesh. Here we will simply generate a mesh of triangles on the square [0,1]x[0,1] with Δx=2^(-5). To do so, we use the code:</p><pre><code class="language-julia">Δx = 1//2^(5)
fem_mesh = notime_squaremesh([0 1 0 1],Δx,:dirichlet)</code></pre><p>Note that by specifying :dirichlet our boundary conditions is set on all boundaries to dirichlet. This gives an FEMmesh object which stores a finite element mesh in the same layout as <a href="http://www.math.uci.edu/~chenlong/programming.html">iFEM</a>. Notice this code shows that the package supports the use of rationals in meshes. Other numbers such as floating point and integers can be used as well. Finally, to solve the equation we use</p><pre><code class="language-julia">sol = solve(fem_mesh,pdeProb)</code></pre><p>solve takes in a mesh and a PoissonProblem and uses the solver to compute the solution. Here the solver was chosen to be GMRES. Other solvers can be found in the documentation. This returns a FEMSolution object which holds data about the solution, such as the solution values (u). To plot the solution, we use the command</p><pre><code class="language-julia">plot(sol::FEMSolution)
Plots.gui()</code></pre><p>Here is the plot shown against the analytical solution to show the accuracy:</p><p><img src="https://raw.githubusercontent.com/JuliaDiffEq/DifferentialEquations.jl/master/examples/plots/introductionExample.png" alt="Poisson Example Solution"/></p><footer><hr/><a class="previous" href="sde_example.html"><span class="direction">Previous</span><span class="title">Stochastic Differential Equation (SDE) Example</span></a><a class="next" href="femheat_example.html"><span class="direction">Next</span><span class="title">Heat Equation Finite Element Method Example</span></a></footer></article></body></html>
